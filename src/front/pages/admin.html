<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Portal Admin - Boy Happy</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
<!-- Export Libraries (CU-25) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
<!-- Chart.js (CU-23) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<!-- STYLES -->
</head>
<body>
<aside class="sidebar">
  <div class="sidebar-logo">
    <i class="fas fa-graduation-cap"></i>
    <span>Boy Happy</span>
  </div>

  <!-- B√∫squeda Global -->
  <div class="global-search">
    <input type="text" id="globalSearchInput" placeholder="üîç Buscar...">
    <div id="searchResults" class="search-dropdown"></div>
  </div>

  <ul class="sidebar-menu">
    <li><a href="#" onclick="showSection('dashboard'); return false;" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
    <li><a href="#" onclick="showSection('comparativo'); return false;"><i class="fas fa-chart-line"></i> Comparativo Cursos</a></li>
    <li><a href="#" onclick="showSection('usuarios'); return false;"><i class="fas fa-users"></i> Gesti√≥n de Usuarios</a></li>
    <li><a href="#" onclick="showSection('matriculas'); return false;"><i class="fas fa-file-alt"></i> Matr√≠culas</a></li>
    <li><a href="#" onclick="showSection('asistencia'); return false;"><i class="fas fa-calendar-check"></i> Asistencia</a></li>
    <li><a href="#" onclick="showSection('materiales'); return false;"><i class="fas fa-folder-open"></i> Materiales</a></li>
    <li><a href="#" onclick="showSection('retroalimentacion'); return false;"><i class="fas fa-comments"></i> Retroalimentaci√≥n</a></li>
    <li><a href="#" onclick="showSection('categorias'); return false;"><i class="fas fa-tags"></i> Categor√≠as</a></li>
    <li><a href="#" onclick="showSection('anuncios'); return false;"><i class="fas fa-bullhorn"></i> Anuncios</a></li>
    <li><a href="#" onclick="showSection('notificaciones'); return false;"><i class="fas fa-envelope"></i> Notificaciones</a></li>
    <li><a href="#" onclick="showSection('configuracion'); return false;"><i class="fas fa-cogs"></i> Configuraci√≥n</a></li>
  </ul>
  <button class="logout-btn" onclick="cerrarSesion()">
    <i class="fas fa-sign-out-alt"></i>
    <span>Cerrar Sesi√≥n</span>
  </button>
</aside>

<main class="main-content">
  <!-- Dashboard Section (CU-24) -->
  <div id="dashboard" class="section active">
    <div class="content-header">
      <h1><i class="fas fa-tachometer-alt"></i> Dashboard de Indicadores</h1>
      <button class="btn btn-primary" onclick="cargarDashboard()"><i class="fas fa-sync"></i> Actualizar</button>
    </div>

    <!-- Indicadores Principales -->
    <div id="indicadoresPrincipales" class="dashboard-grid">
      <div class="indicator-card">
        <div class="indicator-header">
          <i class="fas fa-users fa-2x"></i>
          <h3>Usuarios Activos</h3>
        </div>
        <div class="indicator-value" id="totalUsuarios">0</div>
        <div class="indicator-trend" id="trendUsuarios"></div>
      </div>

      <div class="indicator-card">
        <div class="indicator-header">
          <i class="fas fa-calendar-check fa-2x"></i>
          <h3>Asistencia Promedio</h3>
        </div>
        <div class="indicator-value" id="promedioAsistencia">0%</div>
        <div class="indicator-semaphore" id="semaforoAsistencia">
          <div class="semaphore-light green"></div>
        </div>
      </div>

      <div class="indicator-card">
        <div class="indicator-header">
          <i class="fas fa-folder fa-2x"></i>
          <h3>Materiales Pendientes</h3>
        </div>
        <div class="indicator-value" id="materialesPendientes">0</div>
        <div class="indicator-semaphore" id="semaforoMateriales">
          <div class="semaphore-light green"></div>
        </div>
      </div>
    </div>

    <!-- Alertas Cr√≠ticas -->
    <div class="card" style="margin-top: 25px;">
      <h3><i class="fas fa-exclamation-triangle"></i> Alertas y Acciones Requeridas</h3>
      <div id="alertasCriticas"></div>
    </div>

    <!-- Resumen por Curso -->
    <div class="card" style="margin-top: 25px;">
      <h3><i class="fas fa-chart-bar"></i> Resumen por Curso</h3>
      <div id="resumenCursos"></div>
    </div>
  </div>

  <!-- Comparativo Multi-Curso Section (CU-23) -->
  <div id="comparativo" class="section">
    <div class="content-header">
      <h1><i class="fas fa-chart-line"></i> Comparativo Multi-Curso</h1>
      <button class="btn btn-primary" onclick="generarComparativo()"><i class="fas fa-sync"></i> Actualizar</button>
    </div>

    <!-- Selector de Cursos -->
    <div class="card">
      <h3><i class="fas fa-filter"></i> Seleccionar Cursos para Comparar</h3>
      <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 15px;">
        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
          <input type="checkbox" class="curso-checkbox" value="medio-mayor" checked>
          <span>Medio Mayor</span>
        </label>
        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
          <input type="checkbox" class="curso-checkbox" value="prekinder-a" checked>
          <span>Prek√≠nder A</span>
        </label>
        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
          <input type="checkbox" class="curso-checkbox" value="prekinder-b" checked>
          <span>Prek√≠nder B</span>
        </label>
        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
          <input type="checkbox" class="curso-checkbox" value="kinder" checked>
          <span>K√≠nder</span>
        </label>
        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
          <input type="checkbox" class="curso-checkbox" value="extension" checked>
          <span>Extensi√≥n Horaria</span>
        </label>
      </div>

      <!-- Filtro de Per√≠odo -->
      <div class="form-row" style="margin-top: 20px;">
        <div class="form-group">
          <label for="comparativoFechaInicio">Per√≠odo Desde</label>
          <input type="date" id="comparativoFechaInicio">
        </div>
        <div class="form-group">
          <label for="comparativoFechaFin">Per√≠odo Hasta</label>
          <input type="date" id="comparativoFechaFin">
        </div>
      </div>
    </div>

    <!-- Gr√°fico de Asistencia -->
    <div class="card" style="margin-top: 25px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3><i class="fas fa-chart-bar"></i> Asistencia Promedio por Curso</h3>
        <button class="btn btn-sm btn-success" onclick="exportarGrafico('chartAsistencia', 'asistencia_comparativo')">
          <i class="fas fa-download"></i> Exportar Gr√°fico
        </button>
      </div>
      <canvas id="chartAsistencia" style="max-height: 400px;"></canvas>
    </div>

    <!-- Gr√°fico de Evoluci√≥n Temporal -->
    <div class="card" style="margin-top: 25px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3><i class="fas fa-chart-line"></i> Evoluci√≥n de Asistencia en el Tiempo</h3>
        <button class="btn btn-sm btn-success" onclick="exportarGrafico('chartEvolucion', 'evolucion_asistencia')">
          <i class="fas fa-download"></i> Exportar Gr√°fico
        </button>
      </div>
      <canvas id="chartEvolucion" style="max-height: 400px;"></canvas>
    </div>

    <!-- Gr√°fico de Niveles de Logro -->
    <div class="card" style="margin-top: 25px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3><i class="fas fa-chart-pie"></i> Distribuci√≥n de Niveles de Logro</h3>
        <button class="btn btn-sm btn-success" onclick="exportarGrafico('chartNiveles', 'niveles_logro')">
          <i class="fas fa-download"></i> Exportar Gr√°fico
        </button>
      </div>
      <canvas id="chartNiveles" style="max-height: 400px;"></canvas>
    </div>

    <!-- Tabla Comparativa -->
    <div class="card" style="margin-top: 25px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3><i class="fas fa-table"></i> Resumen Num√©rico Comparativo</h3>
        <button class="btn btn-sm btn-success" onclick="exportarTablaComparativa()">
          <i class="fas fa-file-excel"></i> Exportar a Excel
        </button>
      </div>
      <div id="tablaComparativa"></div>
    </div>
  </div>

  <!-- Anuncios Section -->
  <div id="anuncios" class="section">
    <div class="content-header">
      <h1><i class="fas fa-bullhorn"></i> Gesti√≥n de Anuncios</h1>
    </div>
    <div class="form-container">
      <form id="anuncioForm">
        <div class="form-group">
          <label for="titulo">T√≠tulo del Anuncio</label>
          <input type="text" id="titulo" placeholder="T√≠tulo" required>
        </div>
        <div class="form-group">
          <label for="contenido">Contenido</label>
          <textarea id="contenido" placeholder="Contenido del anuncio" required style="height: 120px;"></textarea>
        </div>
        <div class="form-group">
          <label for="destinatarios">Destinatarios</label>
          <select id="destinatarios">
            <option value="todos">Todos</option>
            <option value="profesores">Solo Profesores</option>
            <option value="alumnos">Solo Alumnos</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary">Publicar Anuncio</button>
      </form>
    </div>

    <div class="card">
      <h3>Anuncios Publicados</h3>
      <div id="listaAnuncios"></div>
    </div>
  </div>

  <!-- Notificaciones Section -->
  <div id="notificaciones" class="section">
    <div class="content-header">
      <h1><i class="fas fa-envelope"></i> Enviar Notificaciones por Email</h1>
    </div>
    <div class="form-container">
      <form id="notifForm">
        <div class="form-group">
          <label for="destNotif">Destinatarios:</label>
          <select id="destNotif">
            <option value="todos">Todos los usuarios</option>
            <option value="admin">Solo Administradores</option>
            <option value="profesor">Solo Profesores</option>
            <option value="fono">Solo Fonoaudi√≥logos</option>
            <option value="alumno">Solo Alumnos/Apoderados</option>
          </select>
        </div>

        <div class="form-group">
          <label for="asuntoNotif">Asunto:</label>
          <input type="text" id="asuntoNotif" placeholder="Asunto del correo" required>
        </div>

        <div class="form-group">
          <label for="mensajeNotif">Mensaje:</label>
          <textarea id="mensajeNotif" placeholder="Contenido del mensaje..." required style="height: 200px;"></textarea>
        </div>

        <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Enviar Email</button>
      </form>

      <div id="notifStatus" style="margin-top: 20px; padding: 15px; display: none; border-radius: 12px;"></div>
    </div>
  </div>

  <!-- Matr√≠culas Section -->
  <div id="matriculas" class="section">
    <div class="content-header">
      <h1><i class="fas fa-file-alt"></i> Solicitudes de Matr√≠cula</h1>
    </div>
    <div id="listaMatriculas"></div>
  </div>

  <!-- Asistencia Section -->
  <div id="asistencia" class="section">
    <div class="content-header">
      <h1><i class="fas fa-calendar-check"></i> Supervisi√≥n de Asistencia</h1>
    </div>

    <div class="card">
      <h3>Filtros</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="adminAsistenciaCurso">Curso</label>
          <select id="adminAsistenciaCurso" onchange="cargarAsistenciaAdmin()">
            <option value="">Todos los cursos</option>
            <option value="medio-mayor">Medio Mayor</option>
            <option value="prekinder-a">Prek√≠nder A</option>
            <option value="prekinder-b">Prek√≠nder B</option>
            <option value="kinder">K√≠nder</option>
            <option value="extension">Extensi√≥n Horaria</option>
          </select>
        </div>

        <div class="form-group">
          <label for="adminAsistenciaFechaInicio">Desde</label>
          <input type="date" id="adminAsistenciaFechaInicio" onchange="cargarAsistenciaAdmin()">
        </div>

        <div class="form-group">
          <label for="adminAsistenciaFechaFin">Hasta</label>
          <input type="date" id="adminAsistenciaFechaFin" onchange="cargarAsistenciaAdmin()">
        </div>
      </div>
    </div>

    <div id="resumenAsistenciaAdmin" class="card" style="margin-top: 20px;">
      <h3>Resumen General</h3>
      <div style="display: flex; gap: 20px; margin-top: 15px; flex-wrap: wrap;">
        <div class="stat-card presente">
          <i class="fas fa-check"></i>
          <div>
            <h4 id="adminTotalPresente">0</h4>
            <p>Presentes</p>
          </div>
        </div>
        <div class="stat-card ausente">
          <i class="fas fa-times"></i>
          <div>
            <h4 id="adminTotalAusente">0</h4>
            <p>Ausentes</p>
          </div>
        </div>
        <div class="stat-card atrasado">
          <i class="fas fa-clock"></i>
          <div>
            <h4 id="adminTotalAtrasado">0</h4>
            <p>Atrasados</p>
          </div>
        </div>
        <div class="stat-card porcentaje">
          <i class="fas fa-percentage"></i>
          <div>
            <h4 id="adminPorcentajeAsistencia">0%</h4>
            <p>Asistencia</p>
          </div>
        </div>
      </div>
    </div>

    <div id="listaAsistenciaAdmin"></div>
  </div>

  <!-- Categor√≠as Section -->
  <div id="categorias" class="section">
    <div class="content-header">
      <h1><i class="fas fa-tags"></i> Gesti√≥n de Categor√≠as</h1>
      <button class="btn btn-primary" onclick="mostrarFormularioCategoria()"><i class="fas fa-plus"></i> Nueva Categor√≠a</button>
    </div>

    <div id="formCategoria" class="form-container" style="display:none;">
      <h3 id="tituloFormCategoria">Crear Nueva Categor√≠a</h3>
      <div class="form-group">
        <label for="nombreCategoria">Nombre *</label>
        <input type="text" id="nombreCategoria" placeholder="Ej: Matem√°ticas, Lenguaje..." required>
      </div>
      <div class="form-group">
        <label for="descripcionCategoria">Descripci√≥n</label>
        <textarea id="descripcionCategoria" rows="2" placeholder="Descripci√≥n de la categor√≠a (opcional)"></textarea>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="colorCategoria">Color</label>
          <input type="color" id="colorCategoria" value="#4A90E2">
        </div>
        <div class="form-group">
          <label for="iconoCategoria">Icono (FontAwesome)</label>
          <input type="text" id="iconoCategoria" placeholder="folder, book, file..." value="folder">
        </div>
      </div>
      <input type="hidden" id="categoriaIdEditar">
      <button class="btn btn-success" onclick="guardarCategoria()">Guardar Categor√≠a</button>
      <button class="btn btn-secondary" onclick="ocultarFormularioCategoria()">Cancelar</button>
    </div>

    <div class="card">
      <h3>Lista de Categor√≠as</h3>
      <div id="listaCategorias" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;"></div>
    </div>
  </div>

  <!-- Materiales Section (CU-13, 14, 15, 16) -->
  <div id="materiales" class="section">
    <div class="content-header">
      <h1><i class="fas fa-folder-open"></i> Supervisi√≥n de Materiales Pedag√≥gicos</h1>
    </div>

    <div class="card">
      <h3>Filtros</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="filtroEstadoMaterial">Estado</label>
          <select id="filtroEstadoMaterial">
            <option value="">Todos</option>
            <option value="pendiente">Pendiente Revisi√≥n</option>
            <option value="aprobado">Aprobado</option>
            <option value="rechazado">Rechazado</option>
            <option value="requiere_correccion">Requiere Correcci√≥n</option>
          </select>
        </div>
        <div class="form-group">
          <label for="filtroCursoMaterial">Curso</label>
          <select id="filtroCursoMaterial">
            <option value="">Todos</option>
            <option value="medio-mayor">Medio Mayor</option>
            <option value="prekinder-a">Prek√≠nder A</option>
            <option value="prekinder-b">Prek√≠nder B</option>
            <option value="kinder">K√≠nder</option>
          </select>
        </div>
      </div>
      <button class="btn btn-primary" onclick="cargarMateriales()">
        <i class="fas fa-search"></i> Buscar Materiales
      </button>
    </div>

    <div id="listaMateriales" style="margin-top: 20px;"></div>
  </div>

  <!-- Configuraci√≥n Section (CU-11, 12) -->
  <div id="configuracion" class="section">
    <div class="content-header">
      <h1><i class="fas fa-cogs"></i> Configuraci√≥n del Sistema</h1>
    </div>

    <div class="card">
      <h3>Informaci√≥n del Jard√≠n</h3>
      <div class="form-group">
        <label for="nombreJardin">Nombre del Jard√≠n</label>
        <input type="text" id="nombreJardin" placeholder="Nombre del establecimiento">
      </div>
      <div class="form-group">
        <label for="direccionJardin">Direcci√≥n</label>
        <input type="text" id="direccionJardin" placeholder="Direcci√≥n del jard√≠n">
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="telefonoJardin">Tel√©fono</label>
          <input type="tel" id="telefonoJardin" placeholder="+56 9 XXXX XXXX">
        </div>
        <div class="form-group">
          <label for="emailJardin">Email</label>
          <input type="email" id="emailJardin" placeholder="contacto@jardin.cl">
        </div>
      </div>
      <div class="form-group">
        <label for="anoEscolar">A√±o Escolar</label>
        <input type="number" id="anoEscolar" min="2020" max="2050" value="2025">
      </div>
    </div>

    <div class="card">
      <h3>Cursos</h3>
      <div id="listaCursos"></div>
      <button class="btn btn-sm btn-primary" onclick="agregarCurso()" style="margin-top: 10px;">
        <i class="fas fa-plus"></i> Agregar Curso
      </button>
    </div>

    <div class="card">
      <h3>Asignaturas / N√∫cleos de Aprendizaje</h3>
      <div id="listaAsignaturas"></div>
      <button class="btn btn-sm btn-primary" onclick="agregarAsignatura()" style="margin-top: 10px;">
        <i class="fas fa-plus"></i> Agregar Asignatura
      </button>
    </div>

    <button class="btn btn-success" onclick="guardarConfiguracion()">
      <i class="fas fa-save"></i> Guardar Configuraci√≥n
    </button>
  </div>

  <!-- Retroalimentaci√≥n Section (CU-20, 21, 22) -->
  <div id="retroalimentacion" class="section">
    <div class="content-header">
      <h1><i class="fas fa-comments"></i> Gesti√≥n de Retroalimentaci√≥n</h1>
    </div>

    <!-- CU-20: Enviar Retroalimentaci√≥n -->
    <div class="card">
      <h3><i class="fas fa-plus-circle"></i> Enviar Nueva Retroalimentaci√≥n</h3>
      <form id="formRetroalimentacion" onsubmit="enviarRetroalimentacion(event)">
        <div class="form-row">
          <div class="form-group">
            <label for="retroUsuario">Usuario *</label>
            <select id="retroUsuario" required>
              <option value="">-- Seleccionar usuario --</option>
            </select>
          </div>

          <div class="form-group">
            <label for="retroTipo">Tipo de Retroalimentaci√≥n *</label>
            <select id="retroTipo" required>
              <option value="">-- Seleccionar tipo --</option>
              <option value="desempeno_general">üìä Desempe√±o General</option>
              <option value="conducta">üé≠ Conducta</option>
              <option value="logro_destacado">‚≠ê Logro Destacado</option>
              <option value="area_mejora">üìà √Årea de Mejora</option>
              <option value="observacion_general">üìù Observaci√≥n General</option>
              <option value="retroalimentacion_padres">üë®‚Äçüë©‚Äçüëß Retroalimentaci√≥n a Padres</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="retroContenido">Contenido *</label>
          <textarea id="retroContenido" rows="5" required
                    placeholder="Escribe tu retroalimentaci√≥n aqu√≠... S√© espec√≠fico y constructivo."></textarea>
          <small style="color: #666; display: block; margin-top: 5px;">
            <i class="fas fa-lightbulb"></i> Tip: Una buena retroalimentaci√≥n es espec√≠fica, constructiva y orientada a la mejora.
          </small>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="retroVisibilidad">Visibilidad</label>
            <select id="retroVisibilidad">
              <option value="privada">üîí Privada (solo admin/direcci√≥n)</option>
              <option value="publica">üåê P√∫blica (visible para el usuario)</option>
            </select>
          </div>

          <div class="form-group">
            <label for="retroAmbito">√Åmbito (Opcional)</label>
            <select id="retroAmbito">
              <option value="">-- Sin especificar --</option>
              <option value="academico">üìö Acad√©mico</option>
              <option value="conductual">üéØ Conductual</option>
              <option value="socioemocional">‚ù§Ô∏è Socioemocional</option>
              <option value="psicomotor">ü§∏ Psicomotor</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="retroCurso">Curso (Opcional)</label>
          <select id="retroCurso">
            <option value="">-- Sin especificar --</option>
            <option value="medio-mayor">Medio Mayor</option>
            <option value="prekinder-a">Prek√≠nder A</option>
            <option value="prekinder-b">Prek√≠nder B</option>
            <option value="kinder">K√≠nder</option>
          </select>
        </div>

        <button type="submit" class="btn btn-success">
          <i class="fas fa-paper-plane"></i> Enviar Retroalimentaci√≥n
        </button>
      </form>
    </div>

    <!-- CU-22: Ver Historial de Retroalimentaci√≥n -->
    <div class="card" style="margin-top: 25px;">
      <h3><i class="fas fa-history"></i> Historial de Retroalimentaci√≥n</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="historialUsuario">Buscar por Usuario:</label>
          <select id="historialUsuario" onchange="cargarHistorialRetro()">
            <option value="">-- Todos los usuarios --</option>
          </select>
        </div>

        <div class="form-group">
          <label for="filtroTipoRetro">Filtrar por Tipo:</label>
          <select id="filtroTipoRetro" onchange="cargarHistorialRetro()">
            <option value="">Todos los tipos</option>
            <option value="desempeno_general">Desempe√±o General</option>
            <option value="conducta">Conducta</option>
            <option value="logro_destacado">Logro Destacado</option>
            <option value="area_mejora">√Årea de Mejora</option>
            <option value="observacion_general">Observaci√≥n General</option>
            <option value="retroalimentacion_padres">Retroalimentaci√≥n a Padres</option>
          </select>
        </div>

        <div class="form-group">
          <label for="filtroAmbitoRetro">Filtrar por √Åmbito:</label>
          <select id="filtroAmbitoRetro" onchange="cargarHistorialRetro()">
            <option value="">Todos los √°mbitos</option>
            <option value="academico">Acad√©mico</option>
            <option value="conductual">Conductual</option>
            <option value="socioemocional">Socioemocional</option>
            <option value="psicomotor">Psicomotor</option>
          </select>
        </div>
      </div>

      <div id="estadisticasRetro" class="stats-grid" style="margin: 20px 0;"></div>

      <div id="historialRetroalimentacion" style="margin-top: 20px;"></div>
    </div>
  </div>

  <!-- Gesti√≥n de Usuarios Section (Consolidado: Usuarios, Cursos, Profesores, Aceptados) -->
  <div id="usuarios" class="section">
    <div class="content-header">
      <h1><i class="fas fa-users"></i> Gesti√≥n de Usuarios</h1>
    </div>

    <!-- Tabs para sub-secciones -->
    <div class="tabs-container">
      <div class="tabs">
        <button class="tab-btn active" onclick="showEntityTab('usuarios-tab')">
          <i class="fas fa-users"></i> Usuarios
        </button>
        <button class="tab-btn" onclick="showEntityTab('cursos-tab')">
          <i class="fas fa-book"></i> Cursos
        </button>
        <button class="tab-btn" onclick="showEntityTab('profesores-tab')">
          <i class="fas fa-chalkboard-teacher"></i> Profesores
        </button>
        <button class="tab-btn" onclick="showEntityTab('aceptados-tab')">
          <i class="fas fa-check-circle"></i> Alumnos Aceptados
        </button>
      </div>
    </div>

    <!-- Tab: Usuarios -->
    <div id="usuarios-tab" class="entity-tab active">
      <div class="content-header" style="margin-top: 20px;">
        <h2><i class="fas fa-users"></i> Gesti√≥n de Usuarios</h2>
        <button class="btn btn-primary" onclick="mostrarFormularioUsuario()"><i class="fas fa-plus"></i> Nuevo Usuario</button>
      </div>

      <div id="formUsuario" class="form-container" style="display:none;">
        <h3>Crear Nuevo Usuario</h3>
        <div class="form-group">
          <label for="rutUsuario">RUT</label>
          <input type="text" id="rutUsuario" placeholder="12345678-9" required>
        </div>
        <div class="form-group">
          <label for="nombreUsuario">Nombre completo</label>
          <input type="text" id="nombreUsuario" placeholder="Nombre completo" required>
        </div>
        <div class="form-group">
          <label for="correoUsuario">Email</label>
          <input type="email" id="correoUsuario" placeholder="correo@ejemplo.com" required>
        </div>
        <div class="form-group">
          <label for="telefonoUsuario">Tel√©fono</label>
          <input type="tel" id="telefonoUsuario" placeholder="+56 9 1234 5678">
        </div>
        <div class="form-group">
          <label for="rolUsuario">Rol</label>
          <select id="rolUsuario">
            <option value="admin">Administrador</option>
            <option value="profesor">Profesor</option>
            <option value="fono">Fonoaudi√≥logo</option>
            <option value="alumno">Alumno/Apoderado</option>
          </select>
        </div>
        <button class="btn btn-success" onclick="crearUsuario()">Guardar Usuario</button>
        <button class="btn btn-secondary" onclick="ocultarFormularioUsuario()">Cancelar</button>
      </div>

      <div class="card">
        <h3>Lista de Usuarios</h3>
        <table id="tablaUsuarios">
          <thead>
            <tr>
              <th>RUT</th>
              <th>Nombre</th>
              <th>Email</th>
              <th>Tel√©fono</th>
              <th>Rol</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- Tab: Cursos -->
    <div id="cursos-tab" class="entity-tab">
      <div class="content-header" style="margin-top: 20px;">
        <h2><i class="fas fa-book"></i> Cursos</h2>
        <button class="btn btn-primary" onclick="nuevoCurso()"><i class="fas fa-plus"></i> A√±adir Curso</button>
      </div>
      <div class="card">
        <table id="cursosTable">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Profesor a cargo</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- Tab: Profesores -->
    <div id="profesores-tab" class="entity-tab">
      <div class="content-header" style="margin-top: 20px;">
        <h2><i class="fas fa-chalkboard-teacher"></i> Profesores</h2>
        <button class="btn btn-primary" onclick="nuevoProfesor()"><i class="fas fa-plus"></i> A√±adir Profesor</button>
      </div>
      <div class="card">
        <table id="profesoresTable">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Correo</th>
              <th>Tel√©fono</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- Tab: Alumnos Aceptados -->
    <div id="aceptados-tab" class="entity-tab">
      <div class="content-header" style="margin-top: 20px;">
        <h2><i class="fas fa-check-circle"></i> Alumnos Aceptados</h2>
      </div>
      <div class="card">
        <table id="aceptadosTable">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>RUT</th>
              <th>Fecha Nacimiento</th>
              <th>Correo</th>
              <th>Tel√©fono</th>
              <th>Curso</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>
</main>

<!-- Modal eventos -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h2 id="modalTitle">Nuevo Evento/Evaluaci√≥n</h2>
    <form id="eventForm">
      <input type="hidden" id="eventId">
      <div class="form-group">
        <label for="tituloEvento">T√≠tulo</label>
        <input id="tituloEvento" type="text" name="titulo" required>
      </div>
      <div class="form-group">
        <label for="descripcion">Descripci√≥n</label>
        <textarea id="descripcion" name="descripcion"></textarea>
      </div>
      <div class="form-group">
        <label for="fecha">Fecha</label>
        <input id="fecha" type="date" name="fecha" required>
      </div>
      <div class="form-group">
        <label for="hora">Hora</label>
        <input id="hora" type="time" name="hora">
      </div>
      <div class="form-group">
        <label for="tipo">Tipo</label>
        <select id="tipo" name="tipo">
          <option value="evento">Evento</option>
          <option value="evaluacion">Evaluaci√≥n</option>
        </select>
      </div>
      <div class="form-group">
        <label for="curso">Curso</label>
        <select id="curso" name="curso">
          <option value="todos">Todos</option>
          <option value="medio-mayor">Medio Mayor</option>
          <option value="prekinder-a">Prek√≠nder A</option>
          <option value="prekinder-b">Prek√≠nder B</option>
          <option value="kinder">K√≠nder</option>
          <option value="extension">Extensi√≥n Horaria</option>
        </select>
      </div>
      <div style="text-align:center; margin-top:20px;">
        <button type="submit" class="btn btn-primary">Guardar</button>
        <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
        <button type="button" class="btn btn-danger" onclick="deleteEvent()">Eliminar</button>
      </div>
    </form>
  </div>
</div>

<!-- SCRIPT -->
</body>
</html>
